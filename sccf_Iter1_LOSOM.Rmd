---
title: "SCCF LOSOM iter1"
author: "Paul Julian"
output:
  xaringan::moon_reader:
    css: ["default", "libs/WhiteBlue.css"]
    lib_dir: libs
    nature:
      slideNumberFormat: "%current%" 
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
    seal: false
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(knitr)

options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo=FALSE)

##
library(flextable)
library(magrittr)

wd="C:/Julian_LaCie/_Github/LOSOM_ModelEval"

plot.path="C:/Julian_LaCie/_Github/LOSOM_ModelEval/Plots/"

```

layout: true

<div class="my-footer">
<span>  </span>
</div>

---
name: title
class: left, middle

### Lake Okeechobee System Operating Manual

.pull-left[
#### Iteration 1 Modeling - Evaluation

*Sanibel-Captiva Conservation Foundation*

*Conservancy of Southwest Florida*

**DRAFT** - `r format(as.Date(Sys.Date()),"%B %d, %Y")`

]
<!-- this ends up being the title slide since seal = FALSE-->

.pull-right[
```{r ,fig.align="center",out.width="40%"}
knitr::include_graphics('./Plots/SCCF Logo knockout_c.png')
```

```{r ,fig.align="center",out.width="40%"}
knitr::include_graphics('./Plots/ConSWFL.jpeg')
```

]

---
name: alternatives

### Iteration 1 - Model runs

```{r}

data.frame(Alternative=c("LCMECB","LCM25B","ABNE","ECRE","ELOK","ESFL","ESLE","WAS","REC","NAV","WRDC","WRDS","SPAS","SPEF","SPLC"),
           Category=c("LOSOM Existing Condition Baseline 2019", "LOSOM No Action 2025 (FWO)", "Algal Bloom Risk for Northern Estuaries","Ecology - Caloosahatchee Estuary", "Ecology - Lake Okeechobee","Ecology - South Florida", "Ecology - St. Lucie Estuary","Water Supply","Recreation","Navigation","Alternative to address WRDA2020 requirements for Caloosahatchee","Alternative to address WRDA2020 requirements for St Luice","Stakeholder Plan - Audubon","Stakeholder Plan - Everglades Foundation","Stakeholder Plan - Lakeside Communities"),
           Pindex=c(NA,NA,6329,7023,601,"18729 (mode 2)",22448,15122,20814,15617,NA,NA,NA,NA,NA),
           ModelIndex=c(NA,NA,"1C-1_8086","2C_2193","LORS08flex_2827","4BC-2_6132","4C-1_3307","4BC-1_5423","4C-1_687","4BC-1_7802",NA,NA,NA,NA,NA))%>%
  flextable()%>%
  colformat_char(na_str="---")%>%
  width(width=c(1,3.5,1.5,1))%>%
  padding(padding=0.1,part="all")%>%
  font(fontname="Times New Roman",part="all")%>%
  fontsize(size=9,part="body")%>%
  fontsize(size=10,part="header")%>%
  bold(part="header")%>%
  set_header_labels("Pindex"="P Index",
                    "ModelIndex"="Model Index")%>%
  align(j=3:4,part="all",align="center")%>%
  footnote(i=~Alternative=="WRDC",j=~Alternative,
           part="body",value=as_paragraph("Prohibiting high volume releases S77,S78,S79"),ref_symbols =c(" 1 "))%>%
  footnote(i=~Alternative=="WRDS",j=~Alternative,
           part="body",value=as_paragraph("Prohibiting high volume releases S308,S80"),ref_symbols =c(" 2 "))

```

---
name: eval-methods
class: middle


#### Lake Okeechobee 

* Evaluate lake stage consistent with RECOVER - Lake Okeechobee Stage Performance Measure.
  * PM documentation - [link](https://usace.contentdm.oclc.org/utils/getfile/collection/p16021coll7/id/14096)
  * R-package - [link](https://github.com/SwampThingPaul/LORECOVER)

#### Estuaries

* Evaluate estuary discharges consistent with RECOVER thresholds
  * PM documentation - [link](https://usace.contentdm.oclc.org/utils/getfile/collection/p16021coll7/id/14793)

```{r}
cap.val="Flow Envelopes determined as optimum, stressful, and damaging for the corresponding Salinity Envelopes of all indicator species in the Northern Estuaries."
data.frame(Estuary=c("St. Lucie", "Caloosahatchee"),Optimum=c("150 - 1400 cfs","750 - 2100 cfs"),Stress=c("1400 - 1700 cfs","2100 - 2600 cfs"),Damaging=c(">1700 cfs",">2600 cfs"))%>%
  flextable()%>%
  width(width=c(1,1.5,1.5,1))%>%
  padding(padding=0.5,part="all")%>%
  font(fontname="Times New Roman",part="all")%>%
  # fontsize(size=10,part="body")%>%
  # fontsize(size=11,part="header")%>%
  bold(part="header")%>%
  align(align="center",part="all")%>%
  bg(i=1,bg="grey90")%>%
  add_header_lines(values=cap.val)%>%align(align="center",part="header")%>%
  footnote(part="header",value=as_paragraph("Source: RECOVER Northern Estuaries Performance Measure: Salinity Envelope"),ref_symbols =c(" "))
```

* Frequency of low (below optimum), optimum and damaging flow events were evaluated for each water year (May - April) and alternative.


---
name: stat101

### Quick 101

.pull-left[

* How to read box-and-whisker plots or boxplots

```{r ,fig.align="center",out.width="75%"}

knitr::include_graphics('./Plots/boxplot_explain.png')
```

]

.pull-right[

* Stage and flow duration curves are based on cumulative distribution functions. 

```{r ,fig.align="center",out.width="75%"}

knitr::include_graphics('./Plots/ecdf_explain.png')
```

* *Example:* What is the data value 50% (or 0.5) of the time?
  * Follow the red dashed lines and you get a value of -0.04.

More reading on empirical CDF at this [link](https://towardsdatascience.com/what-why-and-how-to-read-empirical-cdf-123e2b922480).
]

---
name: sdc

### Lake Stage Duration Curves

```{r ,fig.align="center",out.width="80%"}

knitr::include_graphics('./Plots/Iteration_1/LO_StageDuration.png')
```

---
name: envelope

### Lake Envelope Score

```{r ,fig.align="center",out.width="60%",fig.cap="Boxplot representing the annual normal and recovery total stage envelope score during the simulation period across alternatives. Dashed line represents the FWO median and green point in boxplot indicates period of simulation mean." }

knitr::include_graphics('./Plots/Iteration_1/LakeO_EnvScore_bxp.png')
```

---
name: envelope2

### Lake Envelope Score Summary
.pull-left[
```{r ,fig.align="center",out.width="100%"}

knitr::include_graphics('./Plots/Iteration_1/LakeO_EnvScore_sum.png')
```
]

.pull-right[
Percent difference of average score relative to the FWO (LSM25B) alternative over the entire simulation period. Both Normal (left) and Recovery (right) envelope scores are presented.

]
---
name: fdc

### Estuary Flow Duration Curves

#### Caloosahatchee River Estuary

```{r ,fig.align="center",out.width="79%"}

knitr::include_graphics('./Plots/Iteration_1/S79_FlowDuration.png')
```

---
name: fdc2

### Flow Duration Curves

#### C-43 Canal

```{r ,fig.align="center",out.width="79%"}

knitr::include_graphics('./Plots/Iteration_1/S77_FlowDuration.png')
```


---
name: freq

### Flow Categories

```{r ,fig.align="center",out.width="55%",fig.cap="Boxplot representing the frequency of low, optimum and damaging flow events during the simulation period across alternatives. Dashed line represents the FWO median and green point in boxplot indicates period of simulation annual mean." }
knitr::include_graphics('./Plots/Iteration_1/CRE_iter1_freq_bxp.png')
```

---
name: DrySeason2

### Dry Season Discharges
```{r ,fig.align="center",out.width="60%",fig.cap="Boxplot representing the annual percent dry season discharge during the simulation period across alternatives. Dashed line represents the FWO median and green point in boxplot indicates period of simulation mean." }
knitr::include_graphics('./Plots/Iteration_1/S79_PercentDryQ_bxp.png')
```

---
name: Source

### Source of Discharges
```{r ,fig.align="center",out.width="50%",fig.cap="Boxplot representing the percent of S-79 discharges originating from the C-43 Basin (top) and Lake Okeechobee (bottom). Dashed line represents the FWO median and green point in boxplot indicates period of simulation mean." }
knitr::include_graphics('./Plots/Iteration_1/S79_PercentBasinQ_bxp.png')
```

---
name: Bloom

### Bloom Period Discharges
```{r ,fig.align="center",out.width="55%",fig.cap="Boxplot representing the percent of S-79 discharges during the July to August (bloom period). Dashed line represents the FWO median and green point in boxplot indicates period of simulation mean." }
knitr::include_graphics('./Plots/Iteration_1/S79_PercentBloomQ_bxp.png')
```

